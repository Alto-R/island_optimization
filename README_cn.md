# 岛屿能源系统优化与气候韧性建模

基于混合整数线性规划(MILP)的岛屿能源系统韧性设计综合优化框架。该模型集成多能源系统与先进的可靠性建模和气候情景分析，为偏远岛屿的可持续能源规划提供支持。

## 🌊 项目概述

本项目实现了专门为面临气候变化挑战的岛屿社区设计的复杂能源系统优化模型。该系统在确保极端天气条件下高可靠性的同时，优化集成电-热-冷能源网络的设计和运行。

### 核心特性
- **多能源集成**: 电力、供热、制冷系统的同步优化
- **气候韧性**: 基于风速和波高阈值的先进灾害建模
- **技术学习**: 纳入新兴技术的预期成本下降
- **可靠性分析**: 蒙特卡洛仿真与智能场景聚类
- **经济优化**: 包含CAPEX、OPEX和运行惩罚的总成本最小化

## 🏗️ 系统架构

### 能源技术(14种类型)

**可再生发电:**
- **WT (风力发电机)**: 陆上风力发电
- **PV (光伏发电)**: 太阳能发电  
- **WEC (波浪能转换器)**: 海洋波浪能发电

**传统能源系统:**
- **LNG (液化天然气)**: 周期性采购的燃料储存
- **CHP (热电联产)**: 天然气热电联产机组

**能源转换:**
- **EB (电锅炉)**: 电力转热能
- **AC (空调系统)**: 电力转冷能
- **PEM (质子交换膜电解槽)**: 电解水制氢
- **FC (燃料电池)**: 氢气发电与废热利用
- **LNGV (LNG气化器)**: LNG气化与冷能回收

**储能系统:**
- **ESS (电储能系统)**: 电池储能
- **TES (热储能)**: 热水/蒸汽储存系统
- **CES (冷储能)**: 冷冻水储存系统  
- **H2S (氢储能)**: 压缩氢气储存

### 可靠性建模

系统采用基于环境条件的复杂故障建模:

**设备故障概率:**
- **基于脆弱性曲线**

**维修约束:**
- 风电/光伏系统: 仅在风速≤20 m/s时可维修
- 波浪能系统: 需要风速≤20 m/s且波高≤2m
- 维修时间: WT/WEC(14天), PV(4天)

## 📊 情景分析

模型包含五个不同情景，代表不同的气候条件和技术成熟度水平:

| 情景文件 | 气候数据 | 技术成本 | 用途 | 输出目录 |
|----------|----------|----------|------|----------|
| `disaster_2020.py` | 2020年基线 | 2020年当前 | 历史基线性能 | `output_2020/` |
| `disaster_2050.py` | 2050年预测 | 2020年当前 | 当前技术下的气候影响 | `output_2050/` |
| `disaster_future_2030.py` | 2050年预测 | 2030年预测 | 早期技术采用效益 | `output_future_2030/` |
| `disaster_future_2040.py` | 2050年预测 | 2040年预测 | 中期技术成熟化 | `output_future_2040/` |
| `disaster_future_2050.py` | 2050年预测 | 2050年预测 | 完全技术学习效应 | `output_future_2050/` |

### 技术成本学习曲线

模型纳入关键技术的现实成本预测:

**氢能技术:**
- PEM电解槽: $1,120/kW → $915/kW → $748/kW (2020→2030→2050)
- 燃料电池: $2,000/kW → $1,800/kW → $1,600/kW (2020→2030→2050)

**储能技术:**
- 电池储能: $784/kWh → $686/kWh → $588/kWh (2020→2030→2050)

**固定成本:** 风电、光伏、LNG等成熟技术在各情景中保持恒定成本。

## 🚀 快速开始

### 环境要求

**必需的Python包:**
```bash
pip install pandas numpy xarray gurobipy scipy geopy pvlib timezonefinder scikit-learn
```

**系统要求:**
- Gurobi优化器及有效许可证
- 最少16GB内存(批量处理建议32GB+)
- Python 3.8+

### 输入数据要求

```
project_root/
├── demand/                         # 逐小时需求曲线
│   ├── demand_{lat}_{lon}.csv      # 供热/制冷需求
│   ├── pv_{lat}_{lon}.csv          # 太阳能潜力
│   └── wt_{lat}_{lon}.csv          # 风能潜力
├── CMIP6/                          # 气候模型数据
│   ├── MRI_2020_uas/              # 2020年u风分量
│   ├── MRI_2020_vas/              # 2020年v风分量  
│   ├── MRI_2050_uas/              # 2050年u风预测
│   └── MRI_2050_vas/              # 2050年v风预测
├── wave/                           # 波浪能数据
│   ├── wave_2020.nc               # 2020年波浪能密度
│   ├── waveheight_2020.nc         # 2020年有效波高
│   ├── wave_2050.nc               # 2050年波浪预测
│   └── waveheight_2050.nc         # 2050年波高预测
└── LNG/
    └── LNG_Terminals.xlsx         # 全球LNG终端位置
```

### 单岛执行

```bash
# 运行单个岛屿优化(示例坐标)
python disaster_2020.py --island_lat 25.5 --island_lon 120.0 --pop 1000

# 运行未来情景
python disaster_future_2050.py --island_lat 25.5 --island_lon 120.0 --pop 1000
```

### 批量处理

```bash
# 处理chosen_island.csv中的所有岛屿
chmod +x run_jobs_all.sh

nohup ./run_jobs_all.sh > logs/run_tasks.log 2>&1 &

```

## ⚙️ 模型公式

### 目标函数
最小化系统年化总成本:

```
min: CAPEX年化 + OPEX固定 + LNG成本 + 弃能惩罚 + 削减负荷惩罚
```

**成本组成:**
- **投资成本**: 20年寿命期，5%贴现率年化
- **固定运维**: 与容量成比例的年度维护成本
- **LNG成本**: 采购 + 运输(基于距离) + 固定租船费
- **运行惩罚**: 可再生能源弃能、削减负荷、能量溢出

### 关键约束

**能源平衡(多能源):**
- 电力: 发电 + 储能放电 = 需求 + 转换负荷 + 储能充电
- 热能: EB + CHP热 + FC热 + TES放热 = 供热需求 + TES储热  
- 冷能: AC + LNGV冷 + CES放冷 = 制冷需求 + CES储冷
- 氢气: PEM产氢 + H2S释放 = FC消耗 + H2S储存
- 天然气: LNGV气化 = CHP消耗 + 多余(惩罚)

**可靠性要求:**
- 各能源载体的期望未服务能量(EENS) ≤ 总需求的0.1%
- 通过所有聚类故障情景的等概率权重评估

**储能运行:**
- 循环边界条件(结束状态 = 初始状态)
- 自放电损失: ESS/H2S(0.01%/小时), TES/CES(5%/小时)
- 功率限制: 充放电 ≤ 储能容量的25%

**LNG采购:**
- 每14天周期性采购(3小时分辨率下112个时间步)
- 灾害敏感: 极端天气期间不可采购
- 储存平衡与CHP及气化消耗

### 可靠性分析方法

**1. 蒙特卡洛仿真:**
- 生成1000个独立的设备故障情景
- 可再生技术的天气相关故障概率
- 具有天气约束的维修时间建模

**2. 情景缩减:**
- 提取统计特征: 总停机时间、最大连续故障、事件频率
- 使用轮廓系数自动选择聚类数的K-means聚类
- 选择最接近聚类中心的代表性情景

**3. 鲁棒优化:**
- 确保系统在所有代表性故障情景下的可靠性
- 通过缺额变量最小化最坏情况下的能源短缺

## 📁 输出结构

### 目录组织
```
project_root/
├── output_2020/           # 基线情景结果
├── output_2050/           # 气候变化影响
├── output_future_2030/    # 早期技术采用(2030)
├── output_future_2040/    # 中期技术发展(2040)  
├── output_future_2050/    # 成熟技术情景(2050)
└── logs/                  # 执行日志和错误跟踪
```

### 结果文件(每个岛屿)
**成本分析:**
- `{lat}_{lon}_best_cost.csv`: 完整成本分解(CAPEX、OPEX、燃料、惩罚)

**系统设计:**
- `{lat}_{lon}_capacity.csv`: 所有14种技术类型的最优容量

**运行结果:**
- `{lat}_{lon}_results.csv`: 2,920个时间步的详细运行数据，包括:
  - 各技术发电量
  - 储能充放电循环  
  - 能源转换流量
  - 供需平衡
  - 削减负荷和弃能

### 性能监控
- `logs/main_log.log`: 气候情景详细执行日志
- `logs/main_future_log.log`: 技术情景执行日志  
- `logs/gap_failure_islands.csv`: 超过1% MIP最优性间隙的岛屿

## 🔬 研究应用

### 气候韧性研究
- **影响评估**: 量化气候变化对能源系统性能的影响
- **适应规划**: 识别未来条件下的最优技术组合
- **风险分析**: 评估系统对极端天气事件的脆弱性

### 技术经济学  
- **学习曲线分析**: 建模新兴技术成本下降的效益
- **投资时机**: 优化技术部署时间表
- **经济可行性**: 比较可再生能源与传统系统经济性

### 能源安全
- **可靠性增强**: 设计满足严格可用性要求的系统
- **燃料安全**: 通过本地可再生能源最小化对进口燃料的依赖
- **电网韧性**: 确保设备故障期间的稳定运行

### 政策支持
- **基础设施规划**: 支持长期能源基础设施投资
- **技术激励**: 评估促进可再生能源采用的政策  
- **气候适应**: 指导韧性基础设施发展策略

---

## 📄 许可与引用

本项目为学术研究目的开发。使用该模型时，请引用相关出版物并确认综合气候和可靠性建模方法。

**技术联系**: 如有模型实施问题或合作机会。

---

*英文文档请参见[README.md](README.md)*